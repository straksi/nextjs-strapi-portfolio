// import { use } from "react"
import Link from "next/link"
import Image from "next/image"

import React from "react"
async function getTranding() {
	// const  trending = await fetch('https://api.themoviedb.org/3/trending/all/day?api_key=' + process.env.NEXT_PUBLIC_API_KEY + '&language=ru-RU')
	const portfolio = await fetch(process.env.NEXT_PUBLIC_STRAPI_API_URL + '/api/test-collections?populate=*')
	// await wait(4000)
	return portfolio.json()
}
export default async function Home() {
	// let trending = use(getTranding())
	const portfolio = await getTranding()
	// console.log(portfolio.data.length)
	return (
		<>
			{/* <head title='page 1' /> */}
			<section className="portfolio-section">
				<div className="container">
					<h2 className="title center">КОММЕРЧЕСКИЕ ПРОЕКТЫ</h2>
					<div className="portfolio-grid">
						{portfolio.data?.sort((a, b) => a.id - b.id).map(item => (
							<div className="portfolio-item" key={item.id}>
								{/* <ViewSource pathname="pages/placeholder.js" /> */}
								<Image fill className="portfolio-item__img is-opacity" loading="lazy" sizes="100%" alt={item.attributes.title} src={item.attributes.image.data.attributes.formats.medium.url}
									// priority={true}
									placeholder="blur"
									blurDataURL={item.attributes.base64 !== null ? item.attributes.base64 : "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDABQODxIPDRQSEBIXFRQYHjIhHhwcHj0sLiQySUBMS0dARkVQWnNiUFVtVkVGZIhlbXd7gYKBTmCNl4x9lnN+gXz/2wBDARUXFx4aHjshITt8U0ZTfHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHz/wAARCAHPAzcDASIAAhEBAxEB/8QAGQABAQEBAQEAAAAAAAAAAAAAAAECAwQF/8QAFRABAQAAAAAAAAAAAAAAAAAAAAH/xAAXAQEBAQEAAAAAAAAAAAAAAAAAAQID/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8A+IA6IAAAAAAAAAAAAAAAAAAAIAAoACAAAAAAgACKiAACAAgACKgCKgIACAAiKgCKgIACIqAiKgIACIqAiKgCKgAAAAAAAACooCooKqAKqKgoAKACgAoAKAAACgAAAKigAA9YDaAAAAAAAAAAAAAAAAACAAKAAIAAAAAAAIAAiogAAgAIAAgAIqAgAIACIqAIqAgIAioCIqAgIAioCIqAIqAAAAAAAAAKigKigoAKqKgKigoAKACgAoigAAoAAACoAogD1qg2iiAKIAogAAAAAACiAKIAoggogKqAAAAAAAACAAAICAioAACAAgACACAAgAIioAioCIqAIqAiKgIioCIqAIAIAAAAAgAAAAKgoqooCooKqCCqigoigoAKAAqKAACiKAAAAAAD1gNoAAAAAAAAAAAAAAAIAAoAAAAAAAAAAgAAiAAAioACAAAgAIACAAiKgCKgIACIqAgIAioCIqAiKgICAAAAIAICiKAAAACiKoqoAqoqCqgCqigKigKigKgCgAKigAAAAAA9QDaAAAAAAAACoAogCiCCgCgAAAAAAAAICoAAIgAAAAgACKgAIAACAAgIAioAioCAiAioCIqAiKigggICAIAACAgAAIAACoKKIoCoAqooKqANCKCqgCqgCqgCgAoAAAKIoAAAAPSA2gAAACiAKIAoggoAAAoAAAAAAAAAAAACIAAAACKgAAIAAioAioAioAioAioggAIioCAgCKgIioCIqKIioCAICAAAgAAAAAAAKKIoKIoKqKCqgCqigoigoigoigKgCgAAAKgCiAPSA2gAAqAKIIKIAoiigAAAKIAogCiAKAAIAqAgAAAAAgAACKgAAIAAgAICAgAgAIioAgAiKgIioCIqAiKgIioAgAAIAAAAAAAAAAAAKqCiqigqooKIoKqAKqAKACiKAqAKIoAAAAPQA0gACiAKICqIAoAAACoAogCgAAACCCgAAACAKgAAAAgAACKgAIgAAgAICAIqAIqAiKgCACIqAiKzQGVQEBAAEAAAAAAAAAAAAAABUAaEVRVRQVWVBVQBVRQFQBQAUAAAFEAUQB6AGgAAAAVAFEAURQAAUQBRAFEEFEUAAAAAAAAAAAQAAABEAABAARUARUARUAQAQEAQARFQERUBEVmgVmrUBAEAAAAAAAAAAAAAAAAAABUUFVBRpWVBVRUFEUFEUFEUBUAURQAAAAdxBsUQBRAFABRAFEAUABUEFEAUQBQAAAAAAAAAAAAEAEAAABAAAQAEABAQBFQBBAEVARFQERUBKlKlBEVEAAAAAAAAAAAAAAAAAAAAAAFVFBVZUGhFBVQBVQBQAURQAAUQBRAHZUGxRAFEAUQBRFBRBBRAFEUBUAUQBQAAAUQBRAFEEFEAVAAAAEAAAEABAAQAEAEBEBFQEBAEEAZqpQSotZAQAAAAAAAAAAAAAAAAAAAAAAAFRQVWVBoRQVUAVUUBUAUAFEUAAAAHUQbFEAUQQURQUQBRFAVAFEUBUAUQBQAFQQUQBRFAAAAAEAVAABAAAEABFRARUARUAQAQEAQARFZArNWpQSotQEAAAAAAAAAAAAAAAAAAAAAAAAABVQBpWVBVRQURQURQFQBQAAAAAdBBoURQFQBRAFEUFEAUAFEAUAFEEFAAVAFEAUAAAAEBRAAAAEQVAABAAQAAEBAEVAEAERUBEVASpSpUEqKigAAAAAAAAAAAAAAAAAAAAAAAAAAqANKyoKqKCiKCiKCiKAACiAKIA6CDQogCiAKqAKIAqoAoigKggoigogCgAogCiAKIAogCiAKIIKgAAACAAACAAgAIAICAIqAiKiCJVSglQQEAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAVWVBVRUFEUFAUURQFQBRFAABoQaFEUBUAUQBVQBRFQUQBVQBRFAVAFEUAAFEAUQBRBBQABAFEAAAAQAABAAQAEABABEVEESrUBKlKgCCAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAACoAqoqCiKCiKCiKCiAKIoAANCDYogCiKAqAKIqCiAKqAKACiAKACiAKAgKgCiAKAAAAAAIAqAACAqAAIAAgCKiAgAiKgIioCIAIiooAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoigoioKIoKIoKIAoigAAoDYKgCiCCqgCiKCiAKqAKIoCoAoigoggoACoAogCiKAAAAAIAqAAAAgAAiACAAgCCAIAIioCIqAgCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACiKCiKgogCqgCiAKIA0A2ACCiAKACiKCiAKACiAKqAKIqCiAKAAqAKIAoAAAAAAgCiAAICoCACACACACAgCCICAoiKigAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACiKCiKgAAogCiANANiiAKAgKgCgAoigKgCiKAqAKAgogCgAKgCiAKIAogCiAKIAqAACIKgAIACAAggAIgIIAiooICgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACiAKAgogCiANgNgAAqKAAgKigAAoigAAoigAIKIAoAKIAogCiAKIAogCiAKgIAgACAAgKggAIgIACAoiKigAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAqAKIA6ANAAAqKAAAAgoACoAoAAACoAoigAIKIAogCiAKIAogCoAACAIACAAIACICAAgKCACAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOgK0IKAAAAAAAoCAAAqKAAAAAAAqAKIIKIAogCiAKIAAACCCoICoACAgIACAoIACAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6gNAAAAAAACgAAAAAAoggoAAAAAAICiCCiAKIAAAAgKIIAgAIAAgAACAAgKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOoo0IKAgoAAAAAAAAAAAAAAgAAAAAAAACCCoAAAAgACIKgAIAAIACKKgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7ANAAAAAAAAAAAAAAAAAAAAgAACAKgAAgKgAAiCoAAgAAgIAAIoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7gNAAAAAAAigIKAgAAAAAAAAIAAAAgAgAACKgAICoCAIAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAO4o2IKgAAACAAAAAigIAAAAACAAAAAgAACAgAAgACAgAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPQA2AAAAIKAgAACAACAAAAIqAAAAAgAAIAAgIqAIqAAIIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD0ANgAAAAACCoAAgAAIqAAAIqAAAAgAACKgAAIAgIqAIqIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/2Q=="}

								// srcset={`${item.attributes.image.data.attributes.formats.small.url} 500w,
								// ${item.attributes.image.data.attributes.formats.medium.url} 991w` }
								/>
								<a href={item.attributes.link} aria-label={`Перейти на сайт ${item.attributes.title}`} rel="noreferrer" target="_blank" className="portfolio-item__link"></a>
								<div className="portfolio-item__text">
									<span>{item.attributes.title}</span>
								</div>
								<div className="portfolio-item__text go-to">
									<span>Перейти на сайт</span>
								</div>
							</div>
						))}
					</div>
				</div>
			</section>
		</>
	)
}
async function getBase64ImageUrl(imageId) {
	const blurAmount = 500; // Указываете желаемую степень размытия
  
	// Разделяем ссылку на базовый URL и путь к изображению
	const parts = imageId.split('/upload/');
	const baseUrl = parts[0];
	const imagePath = parts[1];
  
	// Создаем новую ссылку с добавленными параметрами размытия
	const newUrl = `${baseUrl}/upload/w_100,e_blur:${blurAmount}/${imagePath}`;
  
	const response = await fetch(newUrl);
	const buffer = await response.arrayBuffer();
	const data = Buffer.from(buffer).toString('base64');
	return `data:image/jpeg;base64,${data}`;
  }
  